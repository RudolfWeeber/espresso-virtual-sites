\chapter{Setting up interactions}
\label{sec:inter}
\newescommand{inter}

\section{Non-bonded, short-ranged interactions}
\label{sec:inter-nb}
%\quickrefheading{Nonbonded interactions}

\subsection{Lennard-Jones interaction}

\index{Lennard-Jones interaction|mainindex}
\index{interactions!Lennard-Jones|mainindex}
\begin{essyntax}
  inter \var{type1} 
  \var{type2}
  lennard-jones 
  \var{$\epsilon$} \var{$\sigma$} 
  \var{cutoff} \var{shift} \var{offset}
  \begin{features}
    \required{LENNARD_JONES}
  \end{features}
\end{essyntax}
This command will define a Lennard-Jones interaction between particles
of the types \var{type1} and \var{type2}.  The potential is defined by

\begin{equation}
  V_\mathrm{LJ}(r) = \left\{
    \begin{array}{ll}
      4\varepsilon((\frac{\sigma}{r-\mathit{offset}})^{12}
      -(\frac{\sigma}{r-\mathit{offset}})^6+\mathit{shift}) 
      & \mathrm{, if~} r < \mathit{cutoff}+\mathit{offset}\\
      \mathit{0} 
      & \mathrm{, otherwise}\\
    \end{array}
  \right.
\end{equation}

\subsection{Soft-sphere interaction}
\index{soft-sphere interaction|mainindex}
\index{interactions!soft-sphere|mainindex}
\begin{essyntax}
  inter \var{type1} \var{type2} 
  soft-sphere \var{a} \var{n} \var{cut} \var{offset}
\end{essyntax}
\todo{Docs missing.}

\subsection{Lennard-Jones cosine interaction}
\index{Lennard-Jones cosine interactions|mainindex}
\index{interactions!Lennard-Jones cosine|mainindex}
\begin{essyntax}
  \variant{1}
  inter \var{type1} \var{type2} lj-cos
  \var{epsilon} \var{sigma} \var{cutoff} \var{offset}
  \variant{2}
  inter \var{type1} \var{type2} lj-cos2
  \var{epsilon} \var{sigma} \var{offset} \var{$\omega$}
\end{essyntax}
The Lennard-Jones+Cosine potential 
\todo{Create bibtex reference}
(Soddemann et. al. Eur. Phys. J. E. 6, 409-419 (2001))

\todo{Equations} 

Variant \variant{1}: for $r < r_{min} = offset * 2^{\frac{1}{6}} *
\sigma$ :
\begin{center}
$4\varepsilon((\frac{\sigma}{r-offset})^{12}-(\frac{\sigma}{r-offset})^6)$
\end{center}
for $cutoff > r > r_{min} = offset * 2^{\frac{1}{6}} * \sigma$ :
\begin{center}
$\frac{1}{2}\varepsilon(cos(\alpha(r-offset)^2 + \beta)-1)$
\end{center}
where $\alpha$ and $\beta$ are given by:

$\alpha = \frac{\pi}{(cutoff-offset)^2-(r_{min}-offset)^2}$

$\beta = \pi * (1 -
\frac{(r_{min}-offset)^2}{(cutoff-offset)^2-(r_{min}-offset)^2})$

Variant \variant{2}:
for $r < r_{change} = offset * 2^{\frac{1}{6}} * \sigma$ :
\begin{center}
$4 \varepsilon((\frac{\sigma}{r-offset})^{12}-(\frac{\sigma}{r-offset})^6)$
\end{center}
for $cutoff = offset * 2^{\frac{1}{6}} * \sigma + \omega > r > r_{change}$:
\begin{center}
$\varepsilon * cos^2(\frac{\pi * (r - r_{change})}{2 * \omega})$
\end{center}

\subsection{Morse interaction}
\index{Morse interaction|mainindex}
\index{interactions!Morse|mainindex}

\begin{essyntax}
  inter \var{type1} \var{type2} morse
  \var{epsilon} \var{alpha} \var{rmin} \var{cut}
\end{essyntax}
\todo{Docs}

\subsection{Buckingham interaction}
\index{Buckingham interaction|mainindex}
\index{interactions!Buckingham|mainindex}

\begin{essyntax}
  inter \var{type1} \var{type2} buckingham
  \var{A} \var{B} \var{C} \var{D} 
  \var{cut} \var{discontinuity} \var{shift}
\end{essyntax}
\todo{Docs}

\subsection{Tabulated interaction}
\index{tabulated interaction|mainindex}
\index{interactions!tabulated|mainindex}

\begin{essyntax}
  inter \var{type1} \var{type2} tabulated \var{filename}%
  \begin{features}
    \required{TABULATED}
  \end{features}
\end{essyntax}

An arbitrary tabulated non-bonded pair potential.

To use this potential you must provide a file which contains the
tabulated forces and energies as a function of the separation
distance.

At present the required file format is simply an ordered list
separated by whitespace. The data reader first looks for a $\sharp$
character and begins reading from that point in the file. Anything
before the $\sharp$ will be ignored.

The first parameter you should supply in the file is the number of
data points in the table. This should be an integer. Take care when
choosing an appropriate value for the number of points remembering
that a copy of each lookup table is kept on each node and must be
referenced very frequently.

The second parameter you should supply is the minimum tabulated
separation distance. The third parameter should be the maximum
tabulated separation distance This will act as the effective cutoff
value for the potential. Between minval and maxval the force and
energy are assumed to be tabulated at fixed intervals such that the
size of this interval is given by:

$\frac{maxval-minval}{n-1}$

Where $n$ is the number of data points in the table

The remaining data in the file should consist of n data triples
\var{distance} \var{force} \var{energy}. Note that distance is only
included for human readability of the file. Its values do not matter
but it must be present to satisfy the file read format. In the future
a more structured file format will be required for the tabulated input
file. The values of force and energy should be given as follows:

force: $-\frac{U'(r)}{r}$

energy: $U(r)$

\subsection{Gay-Berne interaction}
\index{Gay-Berne interaction|mainindex}
\index{interactions!Gay-Berne|mainindex}

\begin{essyntax}
  inter \var{type1} \var{type2} gay-berne
  \var{epsilon} \var{sigma} \var{cutoff} 
  \var{k1} \var{k2} \var{mu} \var{nu}
\end{essyntax}

The Gay-Berne potential for prolate and oblate particles. The
Gay-Berne potential is an anisotropic version of the classic
Lennard-Jones potential, with orientational dependence in the range
and well-depth functions $\sigma$ and $\epsilon$:

\todo{Typeset formulas}
\[ U(\mathbf{r}_{ij}, \mathbf{\hat{u}}_i, \mathbf{\hat{u}}_j) = 4
\epsilon(\mathbf{\hat{r}}_{ij}, \mathbf{\hat{u}}_i,
\mathbf{\hat{u}}_j) \left[ \left(\frac
    {\sigma_0}{\mathbf{r}_{ij}-\sigma(\mathbf{\hat{r}}_{ij},
      \mathbf{\hat{u}}_i, \mathbf{\hat{u}}_j)+\sigma_0}\right)^{12}-
  \left(\frac {\sigma_0}{\mathbf{r}_{ij}-\sigma(\mathbf{\hat{r}}_{ij},
      \mathbf{\hat{u}}_i, \mathbf{\hat{u}}_j)+\sigma_0}\right)^{6}
\right] \]

where

\[ \sigma( \mathbf{\hat{r}}_{ij}, \mathbf{\hat{u}}_i,
\mathbf{\hat{u}}_j) = \sigma_{0} \left\{ 1 - \frac{1}{2} \chi \left[
    \frac{ \left( \mathbf{\hat{r}}_{ij} \cdot \mathbf{\hat{u}}_i +
        \mathbf{\hat{r}}_{ij} \cdot \mathbf{\hat{u}}_j \right)^{2} }
    {1 + \chi \left( \mathbf{\hat{u}}_i.\mathbf{\hat{u}}_j \right) } +
    \frac{ \left( \mathbf{\hat{r}}_{ij} \cdot \mathbf{\hat{u}}_i -
        \mathbf{\hat{r}}_{ij} \cdot \mathbf{\hat{u}}_j \right)^{2} }
    {1 - \chi \left( \mathbf{\hat{u}}_i \cdot \mathbf{\hat{u}}_j
      \right) } \right] \right\}^{-\frac{1}{2}} \]

and

\[ \epsilon(\mathbf{\hat{r}}_{ij}, \mathbf{\hat{u}}_i,
\mathbf{\hat{u}}_j) = \epsilon_0 \left( 1- \chi^{2}(\mathbf{\hat{u}}_i
  \cdot \mathbf{\hat{u}}_j) \right)^{-\frac {\nu}{2}} \left[1-\frac
  {\chi'}{2} \left( \frac { (\mathbf{\hat{r}}_{ij} \cdot
      \mathbf{\hat{u}}_i+ \mathbf{\hat{r}}_{ij} \cdot
      \mathbf{\hat{u}}_j)^{2}} {1+\chi' \, \mathbf{\hat{u}}_i \cdot
      \mathbf{\hat{u}}_j }+ \frac {(\mathbf{\hat{r}}_{ij} \cdot
      \mathbf{\hat{u}}_i-\mathbf{\hat{r}}_{ij} \cdot
      \mathbf{\hat{u}}_j)^{2}} {1-\chi' \, \mathbf{\hat{u}}_i \cdot
      \mathbf{\hat{u}}_j } \right) \right]^{\mu} \]

re unit vectors $ \mathbf{\hat{u}}_i $ and $ \mathbf{\hat{u}}_j $ give
the orientation of the two particles and vector $ \mathbf{r}_{ij} =
r_{ij} \mathbf{\hat{r}}_{ij} $ is the intermolecular vector.

The parameters $ \chi = \frac{k_1^{2} - 1}{k_1^{2} + 1 } $ and $ \chi'
= \frac{k_2^{1/\mu} - 1}{k_2^{1/\mu} + 1 } $ are responsible for the
degree of anisotropy of the molecular properties. $ k_1 $ is the
molecular elongation, and $ k_2 $ is the ratio of the potential well
depths for the side-by-side and end-to-end configurations. Exponents $
\mu $ and $ \nu $ are adjastable parameters of the potential. There
are several Gay-Berne paremeterizations exist; the original one being
$ k_1 = 3 $, $ k_1 = 5 $, $ \mu = 2 $ and $ \nu = 1 $.

\subsection{Capping the force during warmup}

\begin{essyntax}
  inter ljforcecap \var{maxforce}
\end{essyntax}

\todo{For which potentials does it work?}
This command will cap the force to \var{maxforce}, \ie for particle
distances which would lead to larger forces than \var{maxforce} the
Lennard-Jones potential is replaced by \var{$r*maxforce$}. Particles
placed exactly on top of each other will be subject to a force of
magnitude \var{maxforce} applied in $\pm x$ direction. To return to
the uncapped potential you have to set \var{maxforce} to $0$.  Note
that \keyword{ljforcecap} applies to all given Lennard-Jones
interactions regardless of the particle types.

\section{Bonded interactions}
\label{sec:inter-bonded}
\index{bonded interactions|mainindex}
\index{interactions!bonded|mainindex}

\index{bonded interaction type id} Bonded interactions possess an
\emph{bonded interaction type id}. On the one hand, this id is used
when particles and bonds between particles are specified in the
command \texttt{part} (see section \vref{tcl:part}).  On the other
hand, the id is used when the interaction is specified.

\subsection{FENE bond}
\index{FENE bond|mainindex}
\index{interactions!FENE|mainindex}

\begin{essyntax}
  inter \var{bond_type_number} 
  fene
  \var{K_fene} \var{R_fene}
\end{essyntax}

\[ U^{FENE} = -\frac{1}{2} K_{FENE} R_{FENE}^2 \ln \left( 1 - \left( \frac{r}{R_{FENE}} \right)^2 \right) \]

\subsection{Harmonic bond}
\index{harmonic bond|mainindex}
\index{interactions!harmonic|mainindex}

\begin{essyntax}
  inter \var{bond_type_number} 
  harmonic
  \var{K_harmonic R_harmonic}
\end{essyntax}

\[ U^{Harmonic} = \frac{1}{2} K_{harmonic} \left( r - R_{harmonic} \right)^2 \] 

\subsection{Subtracted Lennard-Jones bond}
\index{subtracted Lennard-Jones bond|mainindex}
\index{interactions!subtracted Lennard-Jones|mainindex}

\begin{essyntax}
  inter \var{bond_type_number} 
  subt_lj
  \var{K_subt_lj} \var{R_subt_lj}
\end{essyntax}

This "bonded" interaction subtracts the Lennard-Jones force/energy of
every bonded pair from the total force/energy. The first parameter,
\var{K_subt_lj} is a dummy and is not used. The second parameter,
\var{R_subt_lj} is used as a check. If the any bond length in the
system exceeds this value, the program crashes. When not needed, this
crashing can be disabled by commenting out a few lines in
\texttt{subt_lj.h}.  When using this "bonded" interaction, it is
worthwhile to consider capping the Lennard-Jones potential
appropriately so that round-off errors can be avoided.

\subsection{Bond-angle interactions}
\index{bond-angle interactions|mainindex}
\index{interactions!bond-angle|mainindex}

\begin{essyntax}
  inter \var{bond_type_number} 
  angle \var{bend} \opt{\var{phi0}}
\end{essyntax}

\var{bend} is the bending constant in units of $k_BT$. The optional
parameter \var{phi0} = $ \phi_o $ is the equilibirum bond angle in rad
ranging from 0 to $ \pi $. If this paramter is not given the default
value is $ \phi_o = \pi $ which corresponds to a stretched
configuration.

\begin{itemize}
\item Harmonic bond angle potential: (flag: BOND_ANGLE_HARMONIC)
  This potential is also used for example in YASP and good old polyMD.

      \[ U^{bend}_{harmonic} = \frac{bend}{2} (\phi - \phi_0)^2 \]

    \item Cosine bond angle potential: (flag: BOND_ANGLE_COSINE) The
      \es{} original!

      \[ U^{bend}_{cosine} = \frac{bend}{2} (1 + \cos(\phi - \phi0)) \]

    \item Cosine square bond angle potential: (flag:
      BOND_ANGLE_COSSQUARE) A form which is used for example in the
      GROMOS96 force field.

      \[ U^{bend}_{cossquare} = \frac{bend}{2} (\cos(\phi) - \cos(\phi_0))^2 \] 
\end{itemize}

\subsection{Dihedral interactions}
\index{dihedral interactions|mainindex}
\index{interactions!dihedral|mainindex}

\begin{essyntax}
  inter \var{bond_type_number} 
  dihedral \var{mult} \var{bend} \var{phase}
\end{essyntax}

\[ U^{dihedral} = bend \, (1 + phase \, \, cos(mult \, \phi)) \]

Here $\phi$ is the dihedral angle defined by the particle quadrupel
p1, p2, p3 and p4. \var{mult} is the multiplicity of the potential
(number of minimas) and can take integer values from 1 to 6.
\var{phase} is a phase parameter which takes the values $\pm1$ and
\var{bend} is the bending constant of the potential. Together with
appropriate Lennard-Jones interaction this potential can mimic a large
number of atomic torsion potentials. The dihedral angle is the angle
between the planes defined by the particle triples p1, p2 and p3 and
p2, p3 and p4 as illustrated in the figure to the right. Dihedral
bonds have to be stored at particle p2!

\subsection{Tabulated bond interactions}
\index{tabulated bond interactions|mainindex}
\index{interactions!tabulated bond|mainindex}

\begin{essyntax}
    \variant{1} inter \var{bond_type_number} 
    tabulated bond \var{filename}
    \variant{2} inter \var{bond_type_number} 
    tabulated angle \var{filename}
    \variant{3} inter \var{bond_type_number} 
    tabulated dihedral \var{filename}
\end{essyntax}

Tabulated bonded potentials can be any potential for bond length
potentials, bond angle potentials and dihedral angle potentials. The
tabulated forces and energies have to be provided in a seperate file
\var{filename}. The format of this file is identical to the one used
for the non-bonded tabulated potentials (see the section about them
above). The parameter \var{type} defines the type of the potential:

\begin{itemize}
  \item \var{type} = bond (two body interaction)

    Tabulated bond length potential. The force acts in the direction
    of the connecting vector between the particles. The cutoff is
    given by the maximal tabulated distance. For distances smaller
    than the tabulated range it uses a linear extrapolation based on
    the first two tabulated force values. 

  \item \var{type} = angle (three body interaction)

    Tabulated bond angle potential (see also the normal implemented
    bond angle potentials). The force on p_left and p_right acts
    perpendicular to the connecting vector between the particle and
    p_mid and in the plane defined by the three particles. The force
    on the middle particle balances the other two forces. The forces
    are scaled with the invers length of the connecting vectors. It is
    assumed that the potential is tabulated for all angles between 0
    and $ \pi $, where 0 corresponds to a stretched polymer. 

  \item \var{type} = dihedral (three body interaction)

    Tabulated torsional dihedral angle potenetial (see also the normal
    implemented dihedral potentials). It is assumed that the potential
    is tabulated for all angles between 0 and $ 2\pi $. This potential
    is not tested yet! Use on own risk. 
\end{itemize}

\section{Coulomb interaction}
\label{sec:inter-electrostatics}
\index{Coulomb interactions|mainindex}
\index{interactions!Coulomb|mainindex}

\begin{essyntax}
  \variant{1} inter coulomb 0.0
  \variant{2} inter coulomb
\end{essyntax}

Variant \variant{1} completely disables Coulomb interactions hence
deactivating the electrostatic subsystem.  Variant \variant{2} returns
the current parameters of the coulomb interaction as a tcl-list, \eg
\begin{tclcode}
{coulomb 1.0 p3m 7.75 8 5 0.1138 0.0} {coulomb epsilon 0.1
n_interpol 32768 mesh_off 0.5 0.5 0.5}
\end{tclcode}
which has the correct format to be used as input to \keyword{inter} as
well.

\subsection{P3M}
\index{P3M method|mainindex}
\index{interactions!P3M|mainindex}

\begin{essyntax}
  inter coulomb p3m \var{r_cut} \var{mesh} \var{cao} \var{alpha}
\end{essyntax}

\todo{Reference}
Activates the P3M method to handle the Coulomb
interaction
\begin{equation}
  U^{C-P3M} = \ell_B T \frac{q_1 q_2}{r}
\end{equation}
Make sure that you know the relevance of the P3M parameters before
using P3M!

\subsubsection{Tuning P3M}
\begin{essyntax}
  inter coulomb p3m \alt{tune \asep tunev2}
  accuracy \var{accuracy}\\
  \opt{r_cut \var{r_cut}} 
  \opt{mesh \var{mesh}} 
  \opt{cao \var{cao}} 
  \opt{alpha \var{alpha}}
\end{essyntax}

\todo{Insert docs from \texttt{p3m.h}}

Make sure you know how to tune p3m parameters before using the
automatic tuning feature. Details are described in the documentation
of P3M_tune_parameters rsp P3M_adaptive_tune_parameters.

The two tuning methods follow different methods for determining the
optimal parameter. While the \keyword{tune} version simply tests
different values on a grid in the parameter space, the
\keyword{tunev2} version uses a bisection to determine the optimal
parameters. In general, for small systems the \keyword{tune} version
is faster, while for large systems \keyword{tunev2} is faster. The
results of \keyword{tunev2} are always at least as good as the
parameters achievable from the \keyword{tune} version, and normally
the obtained accuracy is much closer to the desired value.

Note that any previous settings of \var{r_cut}, \var{cao} and
\var{mesh} will be remembered. So if you want to retune your
electrostatics, \eg after a major system change, you should use
\begin{code}
inter coulomb \var{bjerrum} p3m tune accuracy \var{acc} r_cut 0 mesh 0 cao 0
\end{code}
Some additional p3m parameters have preset value
\begin{tclcode}
 epsilon = metallic 
\end{tclcode}
The dielectric constant of the surrounding medium, metallic
(i.e.infinity) or some finite positive number.
\begin{tclcode}
 n_interpol = 32768 
\end{tclcode}
Number of interpolation points for the charge assignment function.
When this is set to 0, interpolation is turned off.
\begin{tclcode}
 mesh_off = 0.5 0.5 0.5 
\end{tclcode}
Offset of the first mesh point from the lower left corner of the
simulation box in units of the mesh constant. As soon as p3m is turned
on the additional parameters can be changed with:
\begin{code}
inter coulomb \var{parameter_name} \var{value}+
\end{code}


\subsection{Debye-H\"uckel potential}
\index{Debye-H\"uckel potential|mainindex}
\index{interactions!Debye-H\"uckel|mainindex}

\begin{essyntax}
  inter coulomb dh \var{kappa} \var{r_cut}
\end{essyntax}
\[ U^{C-DH} = \ell_B T \frac{q_1 q_2 exp(-\kappa r)}{r} \]

For

\[ \kappa = 0 \]

this corresponds to the plain coulomb potential.

\subsection{MMM2D}
\index{MMM2D method|mainindex}
\index{interactions!MMM2D|mainindex}

\begin{essyntax}
 inter coulomb mmm2d \var{maximal_pairwise_error} \opt{\var{fixed_far_cutoff}}
\end{essyntax}
MMM2D coulomb method for systems with periodicity 1 1 0. Needs the
layered cell system. The performance of the method depends on the
number of slices of the cell system, which has to be tuned manually.
It is automatically ensured that the maximal pairwise error is smaller
than the given bound. The far cutoff setting should only be used for
testing reasons, otherwise you are more safe with the automatical
tuning. If you even don't know what it is, do not even think of
touching the far cutoff. For details on the MMM family of algorithms,
refer to appendix \vref{chap:mmm}.

\subsection{MMM1D}
\index{MMM1D method|mainindex}
\index{interactions!MMM1D|mainindex}

\begin{essyntax}
  \variant{1}
  inter coulomb mmm1d \var{switch_radius} 
  \opt{\var{bessel_cutoff}} \var{maximal_pairwise_error}

  \variant{2}  
  inter coulomb mmm1d tune \var{maximal_pairwise_error}
\end{essyntax}
MMM1D coulomb method for systems with periodicity 0 0 1. Needs the
nsquared cell system (see section \vref{sec:cell-systems}). The first
form sets parameters manually. The switch radius determines at which
xy-distance the force calculation switches from the near to the far
formula. If the Bessel cutoff is not explicitly given, it is
determined from the maximal pairwise error, otherwise this error only
counts for the near formula. The second, tuning form just takes the
maximal pairwise error and tries out a lot of switching radii to find
out the fastest one. If this takes too long, you can change the value
of the setmd variable "timings" which controls the number of test
force calculations. For details on the MMM family of algorithms,
refer to appendix \vref{chap:mmm}.

\subsection{Maggs' method}
\index{Maggs' method|mainindex}
\index{interactions!Maggs' method|mainindex}

\begin{essyntax}
  inter coulomb 
  maggs \var{f_mass} \var{mesh} \var{field_friction}
  \opt{yukawa \var{kappa} \var{r_cut}}
\end{essyntax}

This is an implementation of the instantaneous 1/r Coulomb interaction

\[ U = \ell_B T \frac{q_1 q_2}{r} \]

as the potential of mean force between charges which are dynamically
coupled to a local electromagnetic field.

\var{f_mass} is the mass of the field degree of freedom and equals to
the square root of the inverted speed of light.

\var{mesh} is the number of mesh points for the interpolation of the
electromagnetic field

\var{field_friction} value of the friction coefficient for the
transversal field degrees of freedom (reserved for future
developments)

Unphysical self--energies that arise as a result of the lattice
interpolation of charges, are corrected by a subtraction scheme based
either on the exact lattice Green's function or the combination of the
direct subtraction scheme plus the Yukawa subtraction scheme (second
method).

For the case of Yukawa screened simulation (second method) one has to
enter screening parameter \var{kappa} and the cut-off of the Yukawa
potential \var{r_cut}.

\subsection{ELC}
\index{ELC method|mainindex}
\index{interactions!ELC method|mainindex}

\begin{essyntax}
  inter coulomb elc \var{maximal_pairwise_error} \var{gap_size} 
  \opt{\var{far_cutoff}}
\end{essyntax}
This is a special procedure that converts a 3d method, \ie P3M at the
moment, to a 2d method, in computational order N. This is definitely
faster than MMM2D for larger numbers of particles (>400 at reasonable
accuracy requirements). The maximal pairwise error is the LUB error of
the force between any two charges without prefactors (see the papers).
The gap size gives the height of the empty region between the system
box and the neighboring artificial images (again, see the paper).
\es{} does not make sure that the gap is actually empty, this is the
users responsibility. The method will compute fine of the condition is
not fulfilled, however, the error bound will not be reached. Therefore
you should really make sure that the gap region is empty (e. g. by
constraints). The far cutoff finally is only intended for testing and
allows to directly set the cutoff. In this case, the maximal pairwise
error is ignored. The periodicity has to be set to 1 1 1 still, and
the 3d method has to be set to epsilon metallic, i.e.  metallic
boundary conditions. For details, see appendix \vref{chap:mmm}.

Make sure that you read the papers on ELC before using it !!!
\todo{references}

\section{Other interaction types}
\label{sec:inter-other}

\subsection{Fixing the center of mass}
\begin{essyntax}
  inter \var{particle_type_number1} \var{particle_type_number1}
  comfixed \var{comfixed_flag}
\end{essyntax}
This interaction type applies a constraint on particles of type
\var{particle_type_number1} such that during the integration the
center of mass of these particles is fixed. This is accomplished as
follows: The sum of all the forces acting on particles of type
\var{particle_type_number1} are calculated. These include all the
forces due to other interaction types and also the thermostat. Next a
force equal in magnitude, but in the oppositte direction is applied on
the particles. This force is divided equally on all the particles of
type \var{particle_type_number1}, since currently there is no mass
concept in \es. Note that the syntax of the declaration of comfixed
interaction requires the same particle type to be input twice. If
different particle types are given in the input, the program exits
with an error message. The \var{comfixed_flag} can be set to 1 (which
turns on the interaction) or 0 (to turn off the interaction).

\subsection{Pulling particles apart}
\begin{essyntax}
  inter \var{particle_type_number1} \var{particle_type_number2}\\
  comforce \var{comforce_flag} \var{comforce_dir} \var{comforce_force}
  \var{comforce_fratio}
\end{essyntax}
The comforce interaction type enables one to pull away particle groups
of two different types. It is mainly designed for pulling experiments
on bundles. Within a bundle of molecules of type number 1 (t1) lets
mark one molecule as of type 2 (t2). Using comforce one can apply a
force such that t2 can be pulled away from the bundle. The
\var{comforce_flag} is set to 1 to turn on the interaction, and to 0
otherwise. The pulling can be done in two different directions. Either
parallel to the major axis of the bundle ( \var{comforce_dir} = 0) or
perpendicular to the major axis of the bundle (\var{comforce_dir} =
1). \var{comforce_force} is used to set the magnitude of the force.
\var{comforce_fratio} is used to set the ratio of the force applied on
particles of t1 vs t2. This is useful if one has to keep the total
applied force on the bundle and on the target molecule the same. A
force of magnitude \var{comforce_force} is applied on t2 particles,
and a force of magnitude (\var{comforce_force} *
\var{comforce_fratio}) is applied on t1 particles.

\section{Getting the currently defined  interactions}
\begin{essyntax}
  inter
\end{essyntax}
Returns a list of all bonded and non-bonded interactions as a
Tcl-list, in the same formats as above, \eg

\begin{tclcode}
{0 0 lennard-jones 1.0 2.0 1.1225 0.0 0.0} {0 FENE 7.0 2.0} {1 angle
 1.0}
\end{tclcode}



%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "ug"
%%% End: 
